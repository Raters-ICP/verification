// import initSigVerifier, { verifyIcSignature } from '@dfinity/standalone-sig-verifier-web';
const { initSigVerifier, verifyIcSignature } = require('@dfinity/standalone-sig-verifier-web');

async function example(dataRaw, signatureRaw, derPublicKey, root_key) {
    // load wasm module
    await initSigVerifier();
    try {
        // call the signature verification wasm function
        verifyIcSignature(dataRaw, signatureRaw, derPublicKey, root_key);
        console.log('Signature verified successfully');
    } catch (error) {
        // the library throws an error if the signature is invalid
        console.error('Signature verification failed:', error);
    }
}

const paramsSrc = {
  expiration: "17da62794fbfe7d5",
  pubkey:
    "3059301306072a8648ce3d020106082a8648ce3d03010703420004ab93c8faffbd2a291ef421fc2d39bf7fdf353722d191234e2ddd9098538871ae93b0eccb67e52eb6e40828cf8f1c63656566ca943899dca0f78851dc51decad1",
  signature:
    "d9f7a26b636572746966696361746559057cd9d9f7a3647472656583018301830182045820267d108b825149c889227f220ca201138ce621c31c7c3cf174117e7015110bb783024863616e6973746572830183018204582055898d90eccbec76ccb65419eb5af0e7db3c75b5a8e00bd6bd8584c9a2d09cf48301820458209578dbe1f700d75330a9b05d9f8d432b965629be313eaa3480ed738d55b9c9278301830183018301830182045820478f33f42bb03447159cbed473be2e2af993d9e20108694a3936b3cce036efbc830182045820d9d04d5d83ea77024348ea0b5beb315613639dedfdb8695118c8ce9e2746c6e383024a00000000023000c301018301830183024e6365727469666965645f64617461820358203d3665e93d312912a4a2ab01332304ca4348a36b1a56a89b05da30664a9f7672820458201ab3a3bdb7487a462421cfe878e49f9d6a704a254608cd7185dce157d18cb400820458202785bf3305290bec274fd8e70f5f48b6b7f9c120f9a64f4ef00997d373aaea98820458203c43f95566a8ca1de430dc1e91050fdc3d2c68b98afb192bd3b94155bee3dc9e8204582072516b38a70f8ea91f1cc454f11175c25fbadebf6b0f2f538e776834643d6178820458208a2df9ea965c7649537fbdf787b4991041b4f2193a685a7b335e5e41b46fa1bd820458200c1d8c5e6ac378fdf0a339f0d5c434b5380473436cd53cb80eb6a7cc1a9046f5820458209b933396ddf38e9f67d04e581418a828ad30359ae69f6d97ef36102daeb01cc48204582061fb4de4b7f5f74f5a81bc10c61f242c3249d89b12e317173568f0388d424d7f8301820458201746e79ddee7139f9d2478a57b623f6ba78222fe735614724279867ce9c2b89483024474696d65820349d5cff7c384a2cbe817697369676e61747572655830a42009b691aff671d19c8802c36d06654fcf6c176725d1862276eb34d3ab0f86fd285c6720a86814484b96e994d291c16a64656c65676174696f6ea2697375626e65745f6964581d4f82b62edffa3fa4e6a5c48327ce8cfb3f850db2e5abc90e955d77f0026b636572746966696361746559027dd9d9f7a26474726565830182045820bf26837e44a3c5290708437e28b77b4ffcecbb374c4c3faaba57af28cca0ea9c8301830182045820fa81ceb6816fa627e166b91634146a933b1de226ec0ec1345998b7f2f25c1d8f8302467375626e657483018301830182045820f27983ce6bbea65384a725d60b1860f1b4bb9143543444b7784b60ae140631cb830182045820466a70286cf9ace9801ca53e22af6ee059a094fd60498606d484b6854058307d830182045820be72a4c66dc8e7e5566a61cca3fffe9b493ace3d4c0071aac6c49216c764429a830182045820cd351619165247c1c294b8921740af49200d292986ab0536fd2b70c3533a4f0f8302581d4f82b62edffa3fa4e6a5c48327ce8cfb3f850db2e5abc90e955d77f002830183024f63616e69737465725f72616e6765738203581bd9d9f781824a000000000230000001014a00000000023fffff010183024a7075626c69635f6b657982035885308182301d060d2b0601040182dc7c0503010201060c2b0601040182dc7c05030201036100a32153e6271817b87d91d1cd0b727119a2eda7355ee7ef64ee9f10bf6396aed6899a5475d37d6cc51c6a741397d3685318e8e0dabec1b1994112e2c4da3262033ea18fc667dd0ead6e0a151f4d884ee644b799c05e56f502d42f22ffabbca09782045820b78e1a00011a1b04c3504d147453f0edabb16b036f6107ccb7833034527b0b838204582020091b106d33e443bcd1925ba5fd885d53ae3ed90fe991d16f7c7932d736e27483024474696d65820349cdacd282b29289e717697369676e61747572655830ab5cf992986bf9087ba3c4dc1c3abb8d94034f78001aa3de01d4b2fd84bad1891073499480c90a1608696f9d50726dd1647472656583024373696783025820f335fb3609cd5476ecc70cd681c2e35d1e5d3afa8febc2ead7c5bfbbc61fc93783025820a65af812c4f700a94d0fb4cff8726595ccd454a58aca34e8bad1c7c84f479c5d820340",
  publicKey:
    "3c300c060a2b0601040183b8430102032c000a00000000023000c3010162ec117d29497f552aa2ad6eded5351d091dd5d2b6608aca6bfe3c2389889def",
};

// Тестовые данные для проверки подписи
const dataRaw = "Example data to be signed";
const signatureRaw = paramsSrc.signature;
const derPublicKey = paramsSrc.pubkey;
const root_key = paramsSrc.publicKey;

// Вызов функции для проверки подписи
example(dataRaw, signatureRaw, derPublicKey, root_key);
